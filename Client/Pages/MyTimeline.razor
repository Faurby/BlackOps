@page "/mytimeline"
@inject Blazored.LocalStorage.ILocalStorageService localStore
@inject HttpClient Http

<PageTitle>MiniTwit</PageTitle>

<h1>My Timeline</h1>

@if (messages != null)
{
    <ul>

        @foreach (var message in messages)
        {
            <MessageBox message="message"></MessageBox>
        }
    </ul>
}

@code
{

    private User? localUser;
    private Message[]? messages;

    protected override async Task OnInitializedAsync()
    {
        localUser = await localStore.GetItemAsync<User>("user");
        messages = await Http.GetFromJsonAsync<Message[]>("api/Messages/followingMessages/" + localUser!.Id);
    }
}
