@page "/"
@using MiniTwit.Shared
@inject HttpClient Http


<PageTitle>NewIndex</PageTitle>

<link rel=stylesheet type=text/css href="{{ url_for('static', filename='style.css') }}">
<div class=page>
  <h1>Timeline</h1>
  <div class=navigation>
    @* {% if g.user %}
      <a href="{{ url_for('timeline') }}">my timeline</a> |
      <a href="{{ url_for('public_timeline') }}">public timeline</a> |
      <a href="{{ url_for('logout') }}">sign out [{{ g.user.username }}]</a>
      {% else %} *@
    @* {% endif %} *@
  </div>
  @* {% with flashes = get_flashed_messages() %}
    {% if flashes %}
    <ul class=flashes>
    {% for message in flashes %}
    <li>{{ message }}
    {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}
    <div class=body>
    {% block body %}{% endblock %}
    </div>
    <div class=footer>
    MiniTwit &mdash; A Flask Application
    </div>*@

  @if (messages != null)
  {
    <ul>

      @foreach (var message in messages)
      {
        <li>
          <ul>
            <li>@message.AuthorID</li>
            <li>@message.Text</li>
            <li>@message.Timestamp</li>
          </ul>
        </li>
      }
    </ul>
  } 

</div>

@code {
  private Message[]? messages;

  protected override async Task OnInitializedAsync()
  {
    messages = await Http.GetFromJsonAsync<Message[]>("api/Messages");
  }
}